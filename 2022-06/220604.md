# React

**Today I Learned ... **`React.js`

>ğŸ™‹â€â™‚ï¸ [**Reference Lecture**](https://nomadcoders.co/redux-for-beginners)

***


> Redux Lecture
- React Redux
- Redux Toolkit


 
 ## Redux
 
 ğŸ”» ê¸°ì¡´ Hooksë¥¼ ì´ìš©í•œ Todo Appì€?
 
 ``` jsx
import { useState } from 'react';

const Home = () => {
  const [text, setText] = useState('');
  const [todos, setTodos] = useState([]);

  const onChangeInput = (e) => {
    setText(e.target.value);
  };

  const onSubmitForm = (e) => {
    e.preventDefault();
    setTodos([...todos, text]);
    console.log(todos);
    setText('');
  };

  return (
    <>
      <h1>To Do</h1>
      <form onSubmit={onSubmitForm}>
        <input type="text" value={text} onChange={onChangeInput} />
        <button>Add</button>
      </form>
      <ul>
        {todos.map((todo) => (
          <li>{todo}</li>
        ))}
      </ul>
    </>
  );
};
```

### Store ìƒì„±

src/store.js

``` js
import { createStore } from 'redux';

const ADD = 'ADD';
const DELETE = 'DELETE';

export const addToDo = (text) => {
  return {
    type: ADD,
    text,
  };
};

export const deleteToDo = (id) => {
  return {
    type: DELETE,
    id,
  };
};

const reducer = (state = [], action) => {
  switch (action.type) {
    case ADD:
      return [{ text: action.text, id: Date.now() }, ...state];

    case DELETE:
      return state.filter((toDo) => toDo.id !== action.id);

    default:
      return state;
  }
};

const store = createStore(reducer);

export default store;
```

### index (Provider)

react-reduxì˜ Provider ì»´í¬ë„ŒíŠ¸ë¥¼ ì„í¬íŠ¸í•œ í›„,
storeì„ propsë¡œ ì „ë‹¬í•´ì¤Œ.

``` jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import store from './store';
import { Provider } from 'react-redux';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <Provider store={store}>
    <App />
  </Provider>
);
```

### App (Routes)
``` jsx
import { BrowserRouter as Router, Routes, Route } from 'react-router-dom';
import Home from './routes/Home';
import Detail from './routes/Detail';

const App = () => {
  return (
    <Router>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/:id" element={<Detail />} />
      </Routes>
    </Router>
  );
};

export default App;
```

***

## Add ToDo



## connect í•¨ìˆ˜
> ì´ì œëŠ” useSelectorê³¼ useDispatch í›…ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.

### mapStateToProps

``` js
function mapStateToProps(state, ownProps)
```
-> redux storeë¡œë¶€í„° stateë¥¼ ë°›ì•„ì˜´.
ë°˜ë“œì‹œ ë¬´ì–¸ê°€ë¥¼ return í•´ì•¼í•¨.



``` jsx
import { useState } from 'react';
import { connect } from 'react-redux';

const Home = (props) => {
  console.log(props);
  const [text, setText] = useState('');
  const [todos, setTodos] = useState([]);

  const onChangeInput = (e) => {
    setText(e.target.value);
  };

  const onSubmitForm = (e) => {
    e.preventDefault();
    setTodos([...todos, text]);
    setText('');
  };

  return (
    <>
      <h1>To Do</h1>
      <form onSubmit={onSubmitForm}>
        <input type="text" value={text} onChange={onChangeInput} />
        <button>Add</button>
      </form>
      <ul>
        {todos.map((todo) => (
          <li>{todo}</li>
        ))}
      </ul>
    </>
  );
};

// ì¶”ê°€í•œ ë¶€ë¶„
const getCurrentState = (state, ownProps) => {
  return { cute: true };
};

export default connect(getCurrentState)(Home);
```

ğŸ”» ìˆ˜ì •

``` jsx
const mapStateToProps = (state) => {
  return { toDos: state };
  // toDos ë¥¼ í˜„ì¬ ì»´í¬ë„ŒíŠ¸(Home)ì˜ propsë¡œ ì§€ì •í•¨
};

export default connect(mapStateToProps)(Home);
```

-> storeê³¼ ì»´í¬ë„ŒíŠ¸ë¥¼ ì—°ê²°í•œ ê²ƒ. (propsë¡œ ì§€ì •í•´ì£¼ë©´ì„œ)


<br>

### mapDispatchToProps

- connect í•¨ìˆ˜ëŠ” ë‘ê°œì˜ ì¸ìë¥¼ ê°–ëŠ”ë‹¤. 
- í•˜ë‚˜ëŠ” mapStateToProps ì´ê³ , ë‹¤ë¥¸ í•˜ë‚˜ëŠ” mapDispatchToProps ì´ë‹¤.

``` jsx
export default connect(mapStateToProps, mapDispatchToProps)(Home);
```



``` jsx
...
const mapDispatchToProps = (dispatch) => {
  console.log(dispatch);
};

export default connect(mapStateToProps, mapDispatchToProps)(Home);
```


dispatch í•¨ìˆ˜ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
``` js
function dispatch(action) {
    if (!isPlainObject(action)) {
      throw new Error( // ìƒëµ )
    }
    if (typeof action.type === 'undefined') {
      throw new Error( // ìƒëµ );
    }
    if (isDispatching) {
      throw new Error( // ìƒëµ);
    }
	 
    try { 
      isDispatching = true;
      currentState = currentReducer(currentState, action);
    } finally {
      isDispatching = false;
    }

    var listeners = currentListeners = nextListeners;

    for (var i = 0; i < listeners.length; i++) {
      var listener = listeners[i];
      listener();
    }

    return action;
    // ì•¡ì…˜ì„ returní•˜ëŠ” í•¨ìˆ˜ = dispatch
  }
```


### dispatch

``` jsx
import { useState } from 'react';
import { connect } from 'react-redux';
import { actionCreators } from '../store';

const Home = ({ toDos, addTodo }) => {
  const [text, setText] = useState('');

  const onChangeInput = (e) => {
    setText(e.target.value);
  };

  const onSubmitForm = (e) => {
    e.preventDefault();
    // ğŸ”» dispatch í•¨ìˆ˜ í˜¸ì¶œ. (Payloadì¸ text ì „ë‹¬)
    addTodo(text);
    setText('');
  };

  return (
    <>
      <h1>To Do</h1>
      <form onSubmit={onSubmitForm}>
        <input type="text" value={text} onChange={onChangeInput} />
        <button>Add</button>
      </form>
      <ul>{JSON.stringify(toDos)}</ul>
      // ğŸ”º ë°°ì—´ì„ ë¬¸ìì—´ ê·¸ëŒ€ë¡œ ë³´ì—¬ì¤Œ
    </>
  );
};

const mapStateToProps = (state) => {
  return { toDos: state };
};

const mapDispatchToProps = (dispatch) => {
  // ğŸ”» addToDo (ì•¡ì…˜ìƒì„±í•¨ìˆ˜)ë¥¼ ë””ìŠ¤íŒ¨ì¹˜í•¨.
  return {
    addTodo: (text) => dispatch(actionCreators.addToDo(text)),
  };
};

export default connect(mapStateToProps, mapDispatchToProps)(Home);

```

![](https://velog.velcdn.com/images/thisisyjin/post/3523dc4b-e737-4729-8a7c-00641b847afe/image.png)


-> idëŠ” `Date.now()` ë¡œ ì €ì¥ë¨.
``` js
 case ADD:
      return [{ text: action.text, id: Date.now() }, ...state];
```


### Todo ë Œë”ë§

1. components/ToDo.jsx ìƒì„±

``` jsx
const Todo = ({ text, id }) => {
  return (
    <li>
      {text} <button>DEL</button>
    </li>
  );
};

export default Todo;
```

2. Home ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •

``` jsx
import { useState } from 'react';
import { connect } from 'react-redux';
import { actionCreators } from '../store';

import ToDo from '../components/ToDo';

const Home = ({ toDos, addTodo }) => {
  const [text, setText] = useState('');

  const onChangeInput = (e) => {
    setText(e.target.value);
  };

  const onSubmitForm = (e) => {
    e.preventDefault();
    addTodo(text);
    setText('');
  };

  return (
    <>
      <h1>To Do</h1>
      <form onSubmit={onSubmitForm}>
        <input type="text" value={text} onChange={onChangeInput} />
        <button>Add</button>
      </form>
      <ul>
        // ğŸ”» í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ props ì „ë‹¬ (text, id)
        {toDos.map((todo) => (
          <ToDo text={todo.text} id={todo.id} key={todo.id} />
        ))}
      </ul>
    </>
  );
};

const mapStateToProps = (state) => {
  return { toDos: state };
};

const mapDispatchToProps = (dispatch) => {
  return {
    addTodo: (text) => dispatch(actionCreators.addToDo(text)),
  };
};

export default connect(mapStateToProps, mapDispatchToProps)(Home);

```


![](https://velog.velcdn.com/images/thisisyjin/post/816ae9d9-0203-4948-865d-cb4c83f65ca9/image.png)

> âœ… ì°¸ê³  - spread ì´ìš© Props
``` js
{toDos.map((toDo) => (
          <ToDo text={toDo.text} id={toDo.id} key={toDo.id} />
        ))}
```
>  ğŸ”»
``` js
{toDos.map((toDo) => (
          <ToDo {...toDo} key={toDo.id} />
        ))}
```

***

## Delete ToDo


### ownProps ì´ìš©
``` jsx
import { connect } from 'react-redux';
import { actionCreators } from '../store';

const Todo = ({ text, deleteToDo }) => {
  const onClickButton = () => {
    deleteToDo();
  };
  return (
    <li>
      {text} <button onClick={onClickButton}>DEL</button>
    </li>
  );
};

const mapDispatchToProps = (dispatch, ownProps) => {
  return {
    deleteToDo: () => dispatch(actionCreators.deleteToDo(ownProps.id)),
  };
};

export default connect(null, mapDispatchToProps)(Todo);

```
 delete í• ë•ŒëŠ” storeì˜ stateë¥¼ ê°€ì ¸ì˜¬ í•„ìš”ëŠ” ì—†ê³ , dispatchë§Œ í•˜ë©´ ëœë‹¤.
 
 -> connectì˜ ì²«ë²ˆì§¸ ì¸ìë¡œ nullì„ ë„£ì–´ì¤€ë‹¤.
 
`mapDispatchToProps`ì˜ ë‘ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì¸ ownPropsë¥¼ ë³´ë©´ ownProps.idê°€ idì— í•´ë‹¹í•œë‹¤.
-> payloadì¸ idë¡œ ë„£ì–´ì£¼ë©´ ëœë‹¤.
 
 
 ### ë‹¤ë¥¸ ë°©ë²•
 
``` jsx
import { connect } from 'react-redux';
import { actionCreators } from '../store';

const Todo = ({ text, id, deleteToDo }) => {
  const onClickButton = () => {
    deleteToDo(id);
  };
  return (
    <li>
      {text} <button onClick={onClickButton}>DEL</button>
    </li>
  );
};

const mapDispatchToProps = (dispatch) => {
  return {
    deleteToDo: (id) => dispatch(actionCreators.deleteToDo(id)),
  };
};

export default connect(null, mapDispatchToProps)(Todo);
```
ownPropsê°€ ì•„ë‹Œ ì§ì ‘ Todoì—ì„œ propsë¥¼ êµ¬ì¡°ë¶„í•´ë¡œ ë°›ì€ ë‹¤ìŒ, deleteToDoì˜ ì¸ìë¡œ ì „ë‹¬í•´ì£¼ëŠ” ë°©ë²•ë„ ëœë‹¤.

![](https://velog.velcdn.com/images/thisisyjin/post/3b1c4242-a3c7-41c9-9fe9-40d4c6241418/image.gif)


> â—ï¸ ì°¸ê³  - ì•„ë˜ì™€ ê°™ì´ deleteToDoë¥¼ ì§ì ‘ ë„£ì–´ì¤˜ë„ OK.
``` jsx
return (
    <li>
      {text} <button onClick={() => deleteToDo(id)}>DEL</button>
    </li>
  );
```


> â” ì–¸ì œ ownPropsë¥¼ ì“°ê³  ì–¸ì œ ì§ì ‘ ê°’ì„ ëŒ€ì…í•˜ë‚˜?
- í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì˜ propsë¥¼ ì¸ìë¡œ ë„£ì–´ì¤˜ì•¼ í•  ë•ŒëŠ”
`ownProps`ë¥¼ ì“°ì. (ToDo)
>
>
- í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì˜ propsê°€ ì•„ë‹Œ refë‚˜ stateë¥¼ ë„£ì–´ì¤˜ì•¼ í•  ë•ŒëŠ” ì§ì ‘ ì¸ìë¡œ ë°›ì•„ ëŒ€ì…í•˜ì. (Home)


***

## Detail

ToDo.jsx ìˆ˜ì •
``` jsx
import { connect } from 'react-redux';
import { actionCreators } from '../store';
import { Link } from 'react-router-dom';

const Todo = ({ text, deleteToDo, id }) => {
  return (
    <li>
      <Link to={`/${id}`}>
        {text} <button onClick={deleteToDo}>DEL</button>
      </Link>
    </li>
  );
};

const mapDispatchToProps = (dispatch, ownProps) => {
  return {
    deleteToDo: () => dispatch(actionCreators.deleteToDo(ownProps.id)),
  };
};

export default connect(null, mapDispatchToProps)(Todo);

```
`/:id` ë¡œ ì´ë™í•˜ëŠ” Link ì»´í¬ë„ŒíŠ¸ ì¶”ê°€í•¨


Detail.jsx

``` jsx
import { useParams } from 'react-router-dom';

const Detail = () => {
  const { id } = useParams();
  return <div>Detail {id}</div>;
};

export default Detail;
```
-> useParams() ì‚¬ìš©í•¨.

![](https://velog.velcdn.com/images/thisisyjin/post/af10de28-8ff3-41c6-9885-893d11f2242f/image.png)



Detail.jsx ìˆ˜ì •
``` jsx
import { useParams } from 'react-router-dom';
import { connect } from 'react-redux';
import { Link } from 'react-router-dom';

const Detail = ({ toDo }) => {
  const { id } = useParams();
  const toDoText = toDo.find((toDo) => toDo.id === parseInt(id));
  return (
    <>
      <h1>{toDoText.text}</h1>
      <h5>Created at : {id}</h5>
      <Link to="/">Home</Link>
    </>
  );
};

const mapStateToProps = (state) => {
  return {
    toDo: state,
  };
};

export default connect(mapStateToProps)(Detail);
```


![](https://velog.velcdn.com/images/thisisyjin/post/80f2ed7a-682c-4205-8324-5e1ab4e4d93e/image.png)


***

