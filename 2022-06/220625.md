# Recoil

![](https://velog.velcdn.com/images/thisisyjin/post/97518fe2-8e30-41a3-babd-01e438c47467/image.png)



Recoilì€ ì›ì(atom, ê³µìœ ìƒíƒœ) ì—ì„œ Selector(ìˆœìˆ˜ í•¨ìˆ˜)ë¥¼ ê±°ì³
React Componentsë¡œ íë¥´ëŠ” ë°ì´í„° íë¦„ ê·¸ë˜í”„ë¥¼ ë§Œë“¤ê²Œ í•´ì¤Œ.

> `Atom`ì€ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ subscribe í•  ìˆ˜ ìˆëŠ” ìƒíƒœ ë‹¨ìœ„ì´ë‹¤.
`Selector`ì€ ì´ ìƒíƒœë¥¼ ë™ê¸°ì‹ or ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ë³€í™˜í•œë‹¤.




## RecoilRoot

- Reduxì˜ Provider ì—­í• .
- ì—¬ëŸ¬ê°œì˜ RecoilRootê°€ ê³µì¡´í•  ìˆ˜ ìˆê³ , atom stateì˜ ë…ë¦½ì ì¸ ê³µê¸‰ìë¥¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŒ.

- ì»´í¬ë„ŒíŠ¸ - recoil ì—°ë™ì‹œ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì™€ ê°€ì¥ ê°€ê¹Œì´ ìˆëŠ” RecoilRootë¥¼ ì‚¬ìš©í•¨.

``` jsx
import {RecoilRoot} from 'recoil';

function AppRoot() {
  return (
    <RecoilRoot>
      <ComponentThatUsesRecoil />
    </RecoilRoot>
  );
}
```


## Atom

- Recoilì—ì„œ ìƒíƒœë¥¼ ì •ì˜í•˜ëŠ” ë°©ë²•.

``` jsx
import { atom } from 'recoil';

const todoListState = atom({
  key: 'todoListState',
  default: [],
});
```

`const ìƒíƒœ = atom({ })` ì˜ í˜•íƒœë¡œ ì„ ì–¸í•¨.
- ê³ ìœ ê°’ì¸ `key`ì™€ ê¸°ë³¸ê°’ì¸ `default` ë¥¼ ì„¤ì •í•˜ë©´ ë¨.



### useRecoilState

``` jsx
const [todoList, setTodoList] = useRecoilState(todoListState);
```

`useRecoilState()`ëŠ” useStateì²˜ëŸ¼ ë°°ì—´ì„ ë°˜í™˜í•œë‹¤.
ì¸ìë¡œëŠ” atomì˜ keyë¥¼ ì ì–´ì¤€ë‹¤.

êµ¬ì¡°ë¶„í•´ í• ë‹¹ìœ¼ë¡œ 1) state, 2) setState ë¥¼ ì„ ì–¸í•´ì¤€ë‹¤.

`setState`ì˜ ê²½ìš°ì—ëŠ” `setTodoList(todo)`ì™€ ê°™ì´ ê°’ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤. 
(useState ì“°ë“¯ì´)

`todoList`ì™€ `setTodoList`ëŠ” ì•„ë˜ì™€ ê°™ì´ ê°ê° ì„ ì–¸í•´ì¤„ ìˆ˜ ìˆë‹¤.


### useRecoilValue

``` jsx
const todoList = useRecoilValue(todoListState);
```


### useSetRecoilState

``` jsx
const setTodoList = useSetRecoilState(todoListState);
```


## Example

> Todo List ì˜ˆì œ (cr: https://recoiljs.org/docs/basic-tutorial/atoms)

1. TodoList
``` jsx
function TodoList() {
  const todoList = useRecoilValue(todoListState);

  return (
    <>
      {/* <TodoListStats /> */}
      {/* <TodoListFilters /> */}
      <TodoItemCreator />

      {todoList.map((todoItem) => (
        <TodoItem key={todoItem.id} item={todoItem} />
      ))}
    </>
  );
}
```

2. TodoItemCreator
``` jsx
function TodoItemCreator() {
  const [inputValue, setInputValue] = useState('');
  const setTodoList = useSetRecoilState(todoListState);

  const addItem = () => {
    setTodoList((oldTodoList) => [
      ...oldTodoList,
      {
        id: getId(),
        text: inputValue,
        isComplete: false,
      },
    ]);
    setInputValue('');
  };

  const onChange = ({target: {value}}) => {
    setInputValue(value);
  };

  return (
    <div>
      <input type="text" value={inputValue} onChange={onChange} />
      <button onClick={addItem}>Add</button>
    </div>
  );
}

// ê³ ìœ í•œ Id ìƒì„±ì„ ìœ„í•œ ìœ í‹¸ë¦¬í‹°
let id = 0;
function getId() {
  return id++;
}
```


3. TodoItem
-> todoList(state)ë¥¼ `item`ì´ë¼ëŠ” propsë¡œ ì „ë‹¬ë°›ìŒ

``` jsx
function TodoItem({item}) {
  const [todoList, setTodoList] = useRecoilState(todoListState);
  // ğŸ”º todoListë¥¼ ê°€ì ¸ì˜¤ê³ , setTodoListë„ ì„ ì–¸í•¨
  const index = todoList.findIndex(listItem => listItem === item);
  // ì¸ë±ìŠ¤ë¥¼ ì°¾ì•„ì˜´
 

  const editItemText = ({target: {value}}) => {
    const newList = replaceItemAtIndex(todoList, index, {
      ...item,
      text: value,
    });
    setTodoList(newList);
  };

  const toggleItemCompletion = () => {
    const newList = replaceItemAtIndex(todoList, index, {
      ...item,
      isComplete: !item.isComplete,
    });
    setTodoList(newList);
  };

  const deleteItem = () => {
    const newList = removeItemAtIndex(todoList, index);
    setTodoList(newList);
  };

  return (
    <div>
      <input type="text" value={item.text} onChange={editItemText} />
      <input
        type="checkbox"
        checked={item.isComplete}
        onChange={toggleItemCompletion}
      />
      <button onClick={deleteItem}>X</button>
    </div>
  );
}

function replaceItemAtIndex(arr, index, newValue) {
  return [...arr.slice(0, index), newValue, ...arr.slice(index + 1)];
}
// ex> ië²ˆì§¸ ì•„ì´í…œì„ ìˆ˜ì •í•˜ë ¤ë©´?
// [1,2,3,4,5].slice(0, i)
) , newValue , ...[1,2,3,4,5].slice(i+1)]

function removeItemAtIndex(arr, index) {
  return [...arr.slice(0, index), ...arr.slice(index + 1)];
}
// ex> ië²ˆì§¸ ì•„ì´í…œì„ ì œê±°í•˜ë ¤ë©´?
// [1,2,3,4,5].slice(0, i), ... [1,2,3,4,5].slice(0, i+1)
```

### ğŸ”» TIP - ë°°ì—´ íŠ¹ì • ì¸ë±ìŠ¤ ê°’ ë³€ê²½
![](https://velog.velcdn.com/images/thisisyjin/post/83f17608-20f9-4047-9794-5b029312d904/image.png

***

## Selector




