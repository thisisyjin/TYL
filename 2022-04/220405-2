# React.js

**Today I Learned ... **`react.js`

>ğŸ™‹â€â™‚ï¸ [**React.js Reference Book**](https://www.youtube.com/watch?v=Zb70S1I6u6U&list=PLcqDmjxt30RtqbStQqk-eYMK8N-1SYIFn&index=20)

>ğŸ™‹â€ [**My Dev Blog**](https://mywebproject.tistory.com/)



***   

## í…ŒìŠ¤íŠ¸ ìœ„ì£¼ ê°œë°œ ë°©ë²•

### jest ë„êµ¬ ì‚¬ìš©

- CRA(create-react-app) ê¸°ë³¸ í…ŒìŠ¤íŠ¸ í™˜ê²½ 
- package.json íŒŒì¼ì„ ë³´ë©´, "scripts" ì¤‘ì— `test` ë¼ëŠ” ì´ë¦„ì˜ í•­ëª©ì´ ì¡´ì¬í•œë‹¤.

![](https://imagedelivery.net/v7-TZByhOiJbNM9RaUdzSA/3e07751e-9bf3-4b5c-1ccd-aaf475c7ed00/public)




- create-react-appì€ jest ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì‹¤í–‰í•œë‹¤.
-> 1ê°œì˜ í…ŒìŠ¤íŠ¸ íŒŒì¼ì— í¬í•¨ëœ 1ê°œì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ 2ì´ˆê°„ê²©ìœ¼ë¡œ í†µê³¼ë¨.


- jestëŠ” ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ ë„êµ¬ì™€ ë‹¬ë¦¬ ìˆœì°¨ì (X),ë™ì‹œì— ì‹¤í–‰(O)
- ì•„ì£¼ ì§§ì€ ì‹œê°„ì— ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ê²°ê³¼ ì²˜ë¦¬ ê°€ëŠ¥.


``` bash
> yarn test
```


### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±


-íŒŒì¼ëª…ì´ `.test.js` ë¡œ ëë‚˜ê±°ë‚˜, (ë˜ëŠ” .spec.js)
-src/`__tests__` í´ë”ì— ì‘ì„±ëœ js, jsx íŒŒì¼ë“¤ì„ í…ŒìŠ¤íŠ¸í•¨.



src/__tests__/Input.test.jsx


``` jsx
import React from "react";
import ReactDOM from "react-dom"; // React-DOMê¹Œì§€ ì„í¬íŠ¸í•´ì•¼í•¨.
import Input from "../component/Input";

describe("<Input>", () => {   // describe í•¨ìˆ˜
  it("renders without crashing", () => {  // it í•¨ìˆ˜
    const div = document.createElement("div");
    ReactDOM.render(<Input />, div);
    ReactDOM.unmountComponentAtNode(div); // unmountComponentAtNode()
  });
});

```

> **1) describe()**
> describe keywordë¥¼ ì‚¬ìš©í•´ì„œ ì‘ì€ ë‹¨ìœ„ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ **ê·¸ë£¹í™”**í•  ìˆ˜ ìˆë‹¤.
>
>**2) it() / test()**
> ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ì½”ë“œê°€ ë¬´ì—‡ì„ í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œ ì²«ë²ˆì§¸ paramìœ¼ë¡œ ì‘ì„±í•´ì¤€ë‹¤.
ë‘ë²ˆì§¸ paramìœ¼ë¡œëŠ” í…ŒìŠ¤íŠ¸ í†µê³¼ì‹œ ì‹¤í–‰í•  ì½”ë“œ. (ì—¬ê¸°ì„ , Inputì„ divë¡œ ë Œë”ë§í•¨)
>
>**3) ReactDOM.unmountComponentAtNode()**
> DOM ë…¸ë“œê°€ ë§ˆìš´íŠ¸ ëœ í›„, ì œê±°í•˜ê³  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì™€ ìƒíƒœ(state)ë¥¼ ì •ë¦¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©
(ë’·ì •ë¦¬ í•¨ìˆ˜ë¼ê³  ìƒê°í•˜ë©´ ë¨.)


>ì°¸ê³  - ë§ˆìš´íŠ¸ì™€ ì–¸ë§ˆìš´íŠ¸

| ë§ˆìš´íŠ¸ | ì–¸ë§ˆìš´íŠ¸ |
|:--:|:--:|
|ë°›ì•„ì˜¨ propsë¥¼ ê°ì²´ì˜ stateë¡œ ì„¤ì • / setInteval, setTimeout ë“± |ë’·ì •ë¦¬ í•¨ìˆ˜ / clearInterval ë“±|


<br>

ğŸ”» ì•„ë˜ì™€ ê°™ì´ warning msgê°€ ëœ¬ë‹¤.
- inputì— nameì´ ì „ë‹¬ë˜ì–´ì•¼ í•œë‹¤ëŠ” ëœ».

``` bash
Warning: Failed prop type: The prop `name` is marked as required in `Input`, but its value is `undefined`.

       6 |   it("renders without crashing", () => {
       7 |     const div = document.createElement("div");
    >  8 |     ReactDOM.render(<Input />, div);
         |                     ^
       9 |     ReactDOM.unmountComponentAtNode(div);
      10 |   });
      11 | });
```


ìœ„ì™€ ê°™ì´ jestë¥¼ ì´ìš©í•œ `yarn test` ëª…ë ¹ì–´ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë‹¤.


***


### enzyme ë¼ì´ë¸ŒëŸ¬ë¦¬

- ì•ì„œ ë´¤ë˜ jestë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²½ìš°, ReactDOM() í•¨ìˆ˜ë¥¼ ì´ìš©í•œë‹¤.
- `ReactDOM` í•¨ìˆ˜ëŠ” í…ŒìŠ¤íŠ¸ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ ì™¸ì—ë„ **ì—°ê²°ëœ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ ì¶œë ¥**í•˜ëŠ” ë¬¸ì œê°€ ìˆë‹¤.
-> ì˜ˆ> App ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ì‹œ, render()ì— í¬í•¨ëœ Counter, Input ë“±ë„ ê°™ì´ ì¶œë ¥ë¨.


- ë¦¬ì•¡íŠ¸ëŠ” ìš”ì†Œ ì¶”ì¶œ í•¨ìˆ˜ê°€ ì—†ìœ¼ë¯€ë¡œ,
document.getElementById()ì™€ ê°™ì€ DOM í•¨ìˆ˜ì— ì˜ì¡´í•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ìˆìŒ.


- enzymeëŠ” ì»´í¬ë„ŒíŠ¸ì˜ 'ê¸°ëŠ¥'ë§Œì„ ì†ì‰½ê²Œ ê²€ì‚¬í•´ì¤Œ.


1. enzyme ì„¤ì¹˜
```bash
> yarn add --dev enzyme enzyme-adapter-react-16.3 react-test-renderer
```


2. enzyme ì„¤ì • 

- src í´ë”ì— íƒœìŠ¤íŠ¸ ì„¤ì • ì½”ë“œ ì¶”ê°€í•´ì•¼í•¨.
(/src/setupTests.js)

```js
import { configure } from 'enzyme'; // ì„¤ì • í•¨ìˆ˜ configure()
import Adapter from 'enzyme-adapter-react-16.3'; // ìƒëª…ì£¼ê¸° ë¼ì´ë¸ŒëŸ¬ë¦¬

configure({ adpater: new Adapter() }); // ìƒˆ ë²„ì „ ìƒëª…ì£¼ê¸° í•¨ìˆ˜ì™€ í•¨ê»˜ ì¶”ê°€
```


3. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

src/__tests__/Input_spec.jsx

```jsx
import React from "react";
import { shallow } from "enzyme";   // shallow() = í˜„ì¬ ì»´í¬ë„ŒíŠ¸ì˜ ìƒëª…ì£¼ê¸°ë§Œ í…ŒìŠ¤íŠ¸ 
// (ìì‹ ì»´í¬ë„ŒíŠ¸ ìƒì„±, ì¶œë ¥ì€ ê±´ë„ˆëœ€)

import Input from "../component/Input";

describe("<Input>", () => {
  it("renders without crashing", () => {
    expect(() => {
      shallow(<Input />);  // ì˜¤ë¥˜ ë°œìƒ ì•ˆí•˜ë©´ í…ŒìŠ¤íŠ¸ í†µê³¼
    }).not.toThrow(); // toThrow() = ì»´í¬ë„ŒíŠ¸ì˜ ì¶œë ¥ ì˜¤ë¥˜ë¥¼ ê²€ì‚¬.
  });
});

```






<br>

### jest í•¨ìˆ˜ ì„¤ëª…

> ì°¸ê³ ë¬¸ì„œ - [jest ê¸°ë³¸ ì‚¬ìš©ë²•](https://www.daleseo.com/jest-basic/)

#### toThrow()
- ì˜ˆì™¸ ë°œìƒ ì—¬ë¶€ë¥¼ í…ŒìŠ¤íŠ¸í•´ì•¼ í•  ë•Œ ì‚¬ìš©.
- ì—ëŸ¬ê°€ ë‚˜íƒ€ë‚˜ëŠ”ì§€ ê²€ì¦í•˜ê³ , ì˜¤ë¥˜ë°œìƒ ì§€ì ì„ ì•Œ ìˆ˜ ìˆìŒ.


#### expect()
- ê²€ì¦ ëŒ€ìƒì„ ì¸ìˆ˜ë¡œ ë„˜ê¹€.
- íŠ¹ì • ë³€ìˆ˜ë¥¼ ë¹„êµí•˜ê±°ë‚˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì—¬ ë°œìƒí•œ ê²°ê³¼ê°’ì„ ê²€ì¦í•¨.

ì˜ˆ> shallow()ê°€ ë°˜í™˜í•˜ëŠ” ê°ì²´ì˜ ê°œìˆ˜ ê²€ì¦ì‹œ
``` jsx
const wrapper = shallow(<Input />);
expect(wrapper.length).toEqual(1); // toEqual()ì‚¬ìš©
expect(wrapper).toHaveLength(1);  // toHaveLength() ì‚¬ìš©

```


#### spyOn()
- ê²½ê³ ë©”ì‹œì§€ë¥¼ ì˜¤ë¥˜ë¡œ ì¸ì‹í•˜ë„ë¡ ì„¤ì •
-> ì˜¤ë¥˜ í˜¸ì¶œ ê²€ì‚¬ í•¨ìˆ˜ì¸ toThrow()ê°€ ë°œê²¬í•˜ë„ë¡ í•¨

#### beforeEach, afterEach
- ê° í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ì‹¤í–‰ë˜ê¸° ì´ì „ê³¼ ì´í›„ì— íŠ¹ì • ì„¤ì •ì„ ì¶”ê°€ + ë³€ê²½ëœ ì„¤ì •ì„ ì´ˆê¸°í™”.



>ì°¸ê³ 
> yarn test ë’¤ì— íŒŒì¼ê²½ë¡œ or ë””ë ‰í„°ë¦¬ ê²½ë¡œë¥¼ ì‘ì„±í•˜ë©´ í•´ë‹¹ ê²½ë¡œë§Œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥.
``` bash
> > yarn test ./src/__tests__/Input_spec.jsx 
```

â° êµì¬ p.208-216 ìƒëµ.

- shallow() : ì»´í¬ë„ŒíŠ¸ ì¶œë ¥ í›„ ì»´í¬ë„ŒíŠ¸ë¥¼ ê²€ì‚¬í•  ìˆ˜ ìˆëŠ” enzyme ê°ì²´ ë°˜í™˜
-> enzyme ê°ì²´ëŠ” find() ë©”ì„œë“œë¥¼ í¬í•¨í•¨.

- find() : ì—˜ë¦¬ë¨¼íŠ¸ ì¶œë ¥ ê²€ì‚¬ (input, labelë“± ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì¸ìˆ˜ë¡œ)

- prop(), props() : í”„ë¡œí¼í‹°ì— ì „ë‹¬ëœ ê°’ ê²€ì¦
-> ì»´í¬ë„ŒíŠ¸ì— ì „ë‹¬ëœ propsê°€ ì˜ë„ëŒ€ë¡œ render()ì—ì„œ í• ë‹¹ë˜ì—ˆëŠ”ì§€ ê²€ì‚¬.

prop: enzymeê°€ ë°˜í™˜í•œ ì»´í¬ë„ŒíŠ¸ì˜ í”„ë¡œí¼í‹° ì´ë¦„ì„ ì¸ìë¡œ ì „ë‹¬
props: ì „ì²´ í”„ë¡œí¼í‹° ê°’ì„ ê°ì²´ë¡œ ë°˜í™˜

- setProps(): ë³€ê²½ëœ í”„ë¡œí¼í‹°ê°’ ì „ë‹¬
-> ìƒìœ„ ì»´í¬ë„ŒíŠ¸ êµ¬ì„± í›„, ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì˜ stateë¥¼ ë³€ê²½í•´ í…ŒìŠ¤íŠ¸ í–ˆì–´ì•¼ í–ˆìŒ
- setProps()ë¥¼ ì´ìš©í•˜ë©´ ë°”ë¡œ í”„ë¡œí¼í‹° ê°’ ë³€ê²½ ê°€ëŠ¥

``` jsx
const wrapper = shallow(<Input />);
wrapper.setProps({ errorMsg: expectedErrorMessage });
```


- simulate() : ê°€ìƒì˜ ì´ë²¤íŠ¸ ê²€ì‚¬
- ê°€ìƒ ì´ë²¤íŠ¸ ì‘ë™ ê°€ëŠ¥.
- ì½œë°±í•¨ìˆ˜ê°€ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ ê²€ì‚¬ ê°€ëŠ¥.

```jsx
wrapper.find('input').simulate('change', { target: {value: expectedTargetValue} });
```
-> target.valueê°€ ì‹¤ì œ ë¸Œë¼ìš°ì €ê°€ ì „ë‹¬í•˜ëŠ” ê°’ì´ë¯€ë¡œ, ê°ì²´ë¡œ ì¬í˜„í•´ì•¼í•¨. 


- mount() : í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ì¶œë ¥ì‹œ ì‚¬ìš©. (withStyles()í•¨ìˆ˜ì™€ ê°™ì´)
-> ì»¤ë§(í•¨ìˆ˜ì—ì„œ í•¨ìˆ˜ë¥¼ ë¦¬í„´í•˜ëŠ” ê²ƒ)


- dive() : í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ ì¶œë ¥
- mount() í•¨ìˆ˜ëŠ” render()ì— í¬í•¨ëœ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±/ì¶œë ¥í•˜ë¯€ë¡œ ì„±ëŠ¥ ì €í•˜.
- íŠ¹ì • í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë§Œ ì„ íƒí—¤ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ.
-> shallow() ëŠ” í˜„ì¬ ì»´í¬ë„ŒíŠ¸ì˜ ìƒëª…ì£¼ê¸°ë§Œ í…ŒìŠ¤íŠ¸ í•´ì£¼ëŠ” ê²ƒì´ê³ ,
diveëŠ” í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¥¼ ì§€ì •í•´ í…ŒìŠ¤íŠ¸ í•´ì£¼ëŠ” ê²ƒ.


***
## ë³µìŠµ - CheckBox Component


``` jsx

import React, { PureComponent } from "react";
import PropTypes from "prop-types";
import withStyles, { css } from "./withStyles";

class CheckBox extends PureComponent {
  constructor(props) {
    super(props);
    this.setRef = this.setRef.bind(this);
    this.handleClick = this.handleClick.bind(this);
  }

  componentDidMount() {
    if (this.props.autoFocus) {
      this.ref.focus();
    }
  }

  handleClick(e) {
    const { name, onChange } = this.props;
    onChange(name, e.target.checked);
  }

  setRef(ref) {
    this.ref = ref;
  }

  render() {
    const { errorMsg, label, children, styles, checked } = this.props;

    return (
      <label>
        {label}
        <div>
          <input
            ref={this.setRef}
            type="checkbox"
            checked={checked && "checked"}
            onClick={this.handleClick}
          />
          {children}
        </div>
        {errorMsg && (
          <div>
            <span {...css(styles.errorText)}>{errorMsg}</span>
          </div>
        )}
      </label>
    );
  }
}

CheckBox.propTypes = {
  name: PropTypes.string.isRequired,
  autoFocus: PropTypes.bool,
  checked: PropTypes.bool,
  onChange: PropTypes.func,
};

CheckBox.defaultProps = {
  autoFocus: false,
  checked: false,
  onChange: () => {},
};

export default withStyles(({ color, size }) => ({
  errorText: {
    fontSize: size.sm,
    color: color.error,
  },
}))(CheckBox);

```

- ë‹¨ì¶•í‰ê°€ (&&)ë¡œ ifë¬¸ì„ ëŒ€ì²´í•¨. (ì‚¼í•­ì—°ì‚°ìëŠ” if-else ëŒ€ì²´ì‹œ ì‚¬ìš©)
- ì½œë°±í•¨ìˆ˜ ì•ˆì— this ë³€ìˆ˜ë¥¼ ì°¸ì¡°í•˜ë¯€ë¡œ bind()í•˜ì—¬ thisê°€ CheckBox ì»´í¬ë„ŒíŠ¸ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ë¦¬í‚¤ë„ë¡ í•¨.
- onChange() í˜¸ì¶œì‹œ, ì²«ë²ˆì§¸ëŠ” name í”„ë¡œí¼í‹°ë¥¼ , ë‘ë²ˆì§¸ë¡œëŠ” e.target.checkedë¥¼ ì „ë‹¬í•¨.
-


#### withstyles.js ë¶„ì„
- react-with-style ì˜ cssí•¨ìˆ˜, withStylesí•¨ìˆ˜ ì„í¬íŠ¸í•¨
- Theme.js ì„í¬íŠ¸í•¨ (xl,lg,md,sm,xs ë“± ìˆëŠ” ê²ƒ)
- registerTheme í•¨ìˆ˜ë¡œ í…Œë§ˆíŒŒì¼ ë“±ë¡í•¨
- css, withStyles (ì™¸ 4) í•¨ìˆ˜ exportí•¨.


```js
import ThemedStyleSheet from 'react-with-styles/lib/ThemedStyleSheet';
import aphroditeInterface from 'react-with-styles-interface-aphrodite';
import { css, withStyles, withStylesPropTypes } from 'react-with-styles';
import Theme from './Theme';

ThemedStyleSheet.registerTheme(Theme);
ThemedStyleSheet.registerInterface(aphroditeInterface);

export { css, withStyles, withStylesPropTypes, ThemedStyleSheet };
export default withStyles;

```

> ì°¸ê³  - `export`ì™€ `export default`
>
| named export	| default export |
|:--:|:--:|
|export class User {...}|export **default** class User {...}|
|import **{User}** from ...	|import **User** from ...|
