# React.js

**Today I Learned ... **`react.js`

>ğŸ™‹â€â™‚ï¸ [**React.js Lecture**](https://www.youtube.com/watch?v=KDJNjLZrqJk&list=PLcqDmjxt30RtqbStQqk-eYMK8N-1SYIFn&index=18)

>ğŸ™‹â€ [**My Dev Blog**](https://mywebproject.tistory.com/)



***   

## ë‹¤ì¤‘ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸

- í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ëŠ” êµ¬ì¡°ìƒ ë‹¤ë¥¸ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ë¥¼ ì¡°í•©í•  ìˆ˜ ìˆìŒ.
-> ì˜ˆ) Page ì»´í¬ë„ŒíŠ¸ì— ì„œë²„ ë°ì´í„° í˜¸ì¶œ ê¸°ëŠ¥ê³¼ ë¡œë”©ë©”ì‹œì§€ ì¶œë ¥ ê¸°ëŠ¥ì´ í•„ìš”í•˜ë©´ 
-> ê° í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ìƒì„±í•¨ìˆ˜ (withstate, lifecycle ë“±)ì„ ì¡°í•©í•¨.


- ë°˜ë³µëœ ì½”ë“œë¥¼ ì˜ê²Œ ë¶„ë¦¬í•˜ì—¬ ê³µìœ  -> ì½”ë“œì˜ ì–‘ì„ ì¤„ì¼ ìˆ˜ ìˆìŒ.


### 'ë‹¤ì¤‘ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸' ë€?

- `í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸`ë€, ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ì— ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì—¬ ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë°˜í™˜í•˜ëŠ” êµ¬ì¡°ì´ë¯€ë¡œ,
í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ë¥¼ ê²¹ì¹˜ë©´ ê³„ì†í•´ì„œ ì»´í¬ë„ŒíŠ¸ì˜ ê¸°ëŠ¥ì„ í™•ì¥ ê°€ëŠ¥.
- ì—¬ëŸ¬ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ì–´ì„œ í˜¸ì¶œ

``` jsx
function Component() {
  return null;
}

const ComponentWithZ = withZ(Component);
const ComponentWithYandZ = withY(ComponentWithZ);
const ComponentWithXandYandZ = withZ(ComponentWithYandZ);
// ğŸ”º withX(withY(withZ(Component)ì™€ ê°™ìŒ.
```

### compose()
- recompose ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” compose() í•¨ìˆ˜
- ì§€ë‚œë²ˆì— ì§ì ‘ ì´ì¤‘ì»¤ë§ìœ¼ë¡œ êµ¬í˜„í–ˆë˜ compose()í•¨ìˆ˜ì™€ ê°™ì€ ê¸°ëŠ¥ì„ í•¨.

> **ì§ì ‘ ì‘ì„±í–ˆë˜ compose í•¨ìˆ˜ **
```jsx 
function compose() {
    const funcArr = Array.prototype.slice.call(arguments); // ìœ ì‚¬ë°°ì—´ ê°ì²´(arguments)ë¥¼ ë°°ì—´ë¡œ ë§Œë“¬
    return funcArr.reduce(   // reduceí•¨ìˆ˜ë¥¼ ë°˜í™˜í•¨ - ì²«ë²ˆì§¸ ì¸ìˆ˜ë¡œëŠ” ê° ìš”ì†Œ(ì—¬ê¸°ì„  í•¨ìˆ˜)ë¥¼ ë°˜ë³µí•  ì½œë°± ì „ë‹¬
        function (prevFunc, nextFunc) {   // ì»¤ë§ ( âœ”ï¸ í•¨ìˆ˜ë¥¼ ì¡°í•©í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë¦¬í„´í•¨ )
            return function (value) {
                return nextFunc(prevFunc(value));
            }
        },
        function (k) { return k; }  // reduceì˜ ë‘ë²ˆì§¸ ì¸ìˆ˜ë¡œëŠ” ì´ˆê¸°ê°’ì„ ì„¤ì •. (ë§¨ì²˜ìŒ ì¡°í•©ë˜ëŠ” í•¨ìˆ˜)
    );
}
>
const formulaWithCompose = compose(multiplyTwo, multiplyThree, addFour);
```
- ìì„¸í•œ ì„¤ëª…ì€ [ì´ì „ í¬ìŠ¤íŒ…](https://velog.io/@thisisyjin/TIL-22-04-06-1#%ED%95%A8%EC%88%98-%EC%A1%B0%ED%95%A9-%EA%B8%B0%EB%B2%95) ì°¸ì¡°.


- compose í•¨ìˆ˜ ì„í¬íŠ¸
``` jsx
import compose from 'recompose/compose';
const withXYZ = compose(withX, withY, withZ);
const ComponentWithXYZ = withXYZ(Component);
// ğŸ”º const ComponentWithXYZ = compose(withX, withY, withZ)(Component);
```
#### compose()ë¡œ ë‹¤ì¤‘ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©

/src/component/compose.jsx

``` jsx
import compose from 'recompose/compose';
import withLoading from './withLoading'; // í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ìƒì„±í•¨ìˆ˜
import withState from 'recompose/withState';
const withLoadData = withState('isLoading', 'setIsLoading', false); // withState(state, setState, stateì´ˆê¸°ê°’)

function Component() {
  return 'ì™„ë£Œ(ì»´í¬ë„ŒíŠ¸ ì¶œë ¥)';
}

const ComponentWithLoading = withLoading('ë¡œë”© ì¤‘')(Component); // withLoadingì˜ ì¸ìˆ˜ë¡œ loadingMsgë¥¼ ì „ë‹¬
const ComponentWithLoadData = withLoadData(ComponentWithLoading); // withState(..)(ComponentWithLoading) -> withLoadingì—ì„œ ë°˜í™˜í•œ í•˜ì´ì–´ì˜¤ë”ì»´í¬ë„ŒíŠ¸ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬


const withLoadDataAndLoading = compose(withLoadData, withLoading('ë¡œë”© ì¤‘')); // ìˆœì„œ ì£¼ì˜
// withLoadData(withState)ë¥¼ ë¨¼ì € ì •ì˜í•œ í›„ì—, isLoading í”„ë¡œí¼í‹°ë¥¼ withLoadingì— ì „ë‹¬í•´ì•¼í•¨.

const ComponentWithLoadData = withLoadDataAndLoading(ComponentWithLoading);

```

``` jsx
// í¼ì³ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.
withLoadData(withLoading('ë¡œë”© ì¤‘')(Component))
// ë‹¤ì‹œ ë§í•´, ì•„ë˜ì™€ ê°™ë‹¤.
withState('isLoading', 'setIsLoading' false)(withLoading('ë¡œë”© ì¤‘')(Component))

// â– ì—¬ê¸°ì„œ withLoadingì€ branch, ì¦‰ propsì¤‘ isLoadingì´ true, falseì¸ì§€ì— ë”°ë¼ ì»´í¬ë„ŒíŠ¸ë¥¼ ì¶œë ¥.
// ì¦‰, withLoadingì€ ì»¤ë§'í•¨ìˆ˜' ì´ë‹¤.
// ë°˜ë©´, withLoadDataëŠ” (=withStateì˜ ë°˜í™˜ê°’) í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ì´ë‹¤.

```
- compose()ì˜ ì¸ìì—ëŠ” ê°™ì€ ìš”ì†Œê°€ ë“¤ì–´ê°€ì•¼ í•œë‹¤.
-> withLoadingì€ ì»¤ë§í•¨ìˆ˜ì´ê³ , withLoadDataëŠ” í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ì´ë‹¤.  -> ë‹¤ë¥¸ ìš”ì†Œì„.
BUT. withLoading('ë¡œë”© ì¤‘')ì´ ë°˜í™˜í•œ ê°’ì´ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ì´ë¯€ë¡œ ì¡°í•© ê°€ëŠ¥.


> âŒâŒâŒâŒâŒâŒâŒâŒ ìœ„ì— ë¶€ë¶„ ì´í•´ ì•ˆë¨ 


- withState()ì™€ lifecycle() ì•ˆì— `state`ëŠ” ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ì— í”„ë¡œí¼í‹°ë¡œ ì „ë‹¬ë¨.

#### withLoading + lifecycle ì˜ˆì œ(ì„œë²„ìš”ì²­)

``` jsx
import React from 'react';
import lifecycle from 'recompose/lifecycle';
import compose from 'recompose/compose';
import withLoading from './withLoading';

function Page({ content }) {
  return (
    <div>
      í˜ì´ì§€ ë¡œë”©ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
      {content}
    </div>
  );
}

export const withLoadData = lifecycle({
  state: { isLoading: true, content: '' },
  componentDidMount: function () {
    if (this.props.loadData) {
      this.props.loadData().then((content) =>
        this.setState({
          isLoading: false,
          content,
        })
      );
    }
  },
});

export const PageWithLoadData = withLoadData(Page);
export const PageWithLoadDataAndLoading = compose(
  withLoadData,
  withLoading('ì„œë²„ ìš”ì²­ì¤‘')
)(Page);

```


#### ìŠ¤í† ë¦¬ë¶ì— ì¶”ê°€

- ê¸°ì¡´ LifecycleStory.jsx ìˆ˜ì •.

``` jsx
import React from 'react';
import { storiesOf } from '@storybook/react';

import {
  PageWithLoadData,
  PageWithLoadDataAndLoading,
} from '../component/lifecycle';

storiesOf('LifeCycle', module)
  .add('loadData ì˜ˆì œ', () => (
    <PageWithLoadData loadData={() => fetch('/').then(() => 'hello')} />
  ))
  .add('ë¡œë”© ë©”ì‹œì§€ ì˜ˆì œ', () => (
    <PageWithLoadDataAndLoading
      loadData={() => fetch('/').then(() => 'hello')}
    />
  ));

```

<br>

![](https://imagedelivery.net/v7-TZByhOiJbNM9RaUdzSA/81bcafe1-c1f0-4469-122c-be4900f41100/public)

<center>(ë„ˆë¬´ ë¹¨ë¼ì„œ ì˜ ì•ˆë³´ì´ì§€ë§Œ, 'ì„œë²„ìš”ì²­ì¤‘' ì´ë¼ê³  ë¡œë”©ë©”ì‹œì§€ê°€ ëœ¬ë‹¤!)</center>


***

## í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ë³µìŠµ

### í•„ìˆ˜ ì…ë ¥ í•­ëª© í‘œì‹œ ê¸°ëŠ¥ ì»´í¬ë„ŒíŠ¸
- ì…ë ¥ ì»´í¬ë„ŒíŠ¸ì— ì˜¤ë¥˜ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•œ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ 


/src/component/withError.jsx

``` jsx
import React from 'react';
import withStyles, { css } from '../component/withStyles';

export default function (defaultMsg) {  // ì˜¤ë¥˜ë©”ì‹œì§€ë¥¼ ì»¤ë§í•¨ìˆ˜ì˜ ì¸ìë¡œ ì „ë‹¬
  return (WrappedComponent) => {  // WrappedComponentë¥¼ ì¸ìˆ˜ë¡œ ë°›ìŒ
    const { displayName, name: componentName } = WrappedComponent;   // ì»´í¬ë„ŒíŠ¸ ì´ë¦„ í‘œì‹œ
    const wrappedComponentName = displayName || componentName;   // ê¸°ë³¸ê°’ ì„¤ì •

    function ComponentWithError({ hasError, errorMsg, styles, ...props }) {  // í™•ì¥ ì»´í¬ë„ŒíŠ¸. 
      // (hasError ë“± WrappedComponentì— propsë¡œ ì „ë‹¬í•  í•„ìš”ê°€ ì—†ëŠ” ê²ƒì€ ì œì™¸)
      return (
        <>
          <WrappedComponent {...props} />  
          {hasError && <div {...css(styles.error)}>{errorMsg}</div>} { // hasErrorê°€ trueë©´ ì—ëŸ¬ë©”ì‹œì§€ ì¶œë ¥ (ì—ëŸ¬ë©”ì‹œì§€ëŠ” stylesë¡œ ê¾¸ë°ˆ)}
        </>
      );
    }

    ComponentWithError.defaultProps = {
      errorMsg: defaultMsg,   //  ì»¤ë§í•¨ìˆ˜ì˜ ì¸ìë¡œ ë°›ì€ defaultMsgë¥¼ - propsì¸ errorMsgì— í• ë‹¹.
    };

    ComponentWithError.displayName = `withError(${wrappedComponentName})`; 
          
    return withStyles(({ color }) => ({ // style.colorì„ êµ¬ì¡°ë¶„í•´ë¡œ 
      error: {
        color: color.error,
      },
    }))(ComponentWithError);
  };
}
```


