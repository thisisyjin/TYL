# React.js

**Today I Learned ... **`react.js`

>ğŸ™‹â€â™‚ï¸ [**React.js Lecture**](https://www.youtube.com/watch?v=KDJNjLZrqJk&list=PLcqDmjxt30RtqbStQqk-eYMK8N-1SYIFn&index=18)

>ğŸ™‹â€ [**My Dev Blog**](https://mywebproject.tistory.com/)



***  

## Context


### ì»¨í…ìŠ¤íŠ¸ ê¸°ì´ˆ ê°œë…

- `props`ì™€ `state` = ë¶€ëª¨-ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ì—°ê²°ëœ ìƒíƒœì—ì„œ ê³µìœ í•˜ëŠ” ë°ì´í„°
- cf> ë¶€ëª¨-ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ì—°ê²°ë˜ì–´ ìˆì§€ ì•Šì„ë•Œ `context`ë¥¼ í†µí•´ ë°ì´í„° ê³µìœ  ê°€ëŠ¥


- ì»¨í…ìŠ¤íŠ¸ëŠ” **ë°ì´í„° ê³µìœ  ì €ì¥ì†Œ**ì™€ **ë°ì´í„° ì „íŒŒ**ë¥¼ ë‹´ë‹¹.


### ì»´í¬ë„ŒíŠ¸ì˜ êµ¬ì¡°

- ì»´í¬ë„ŒíŠ¸ëŠ” íŠ¸ë¦¬ êµ¬ì¡° í˜•íƒœë¥¼ ë„ê³  ìˆìŒ.
- ìƒìœ„ ->  í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ ì „ë‹¬ì‹œ props ì‚¬ìš©.

- ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìµœí•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ `props`ë¥¼ ì „ë‹¬í•˜ë ¤ë©´ ê·¸ ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ëª¨ë‘ ê±°ì³ì•¼ í•œë‹¤.
-> ë§Œì•½ ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê·¸ propsë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜ ì „ë‹¬ê³¼ì •ì—ì„œ ëˆ„ë½ì´ ë  ì‹œ, ì˜¤ë¥˜ ë°œìƒ.


- propsë¥¼ ì›í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì— ë°”ë¡œ ì „ë‹¬í•˜ë ¤ë©´?  
ğŸ”»

### ê´€ì°°ì íŒ¨í„´ (Observable Pattern)
- ë°ì´í„°ëŠ” **ê³µê¸‰ìê°€ ê´€ë¦¬**í•˜ê³ , **ê´€ì°°ìëŠ” ê³µê¸‰ìë¥¼ êµ¬ë…**í•˜ì—¬ ë°ì´í„°ë¥¼ ì–»ëŠ” ë°©ì‹.
-  ê´€ì°°ì íŒ¨í„´ì„ ë„ì…ì‹œ, ê³µê¸‰ìì™€ ê´€ì°°ìê°€ ì„œë¡œ ì—­í• ì„ ë¶„ë¦¬í•˜ì—¬ ë°ì´í„°ë¥¼ ê´€ë¦¬.

| ê³µê¸‰ì | ê´€ì°°ì (=ì†Œë¹„ì) |
|:--:|:--:|
| ë°ì´í„° ë³´ê´€, ë³€ê²½, ì†Œë¹„ìì—ê²Œ ë°ì´í„° ê³µê¸‰ | ê³µê¸‰ìë¥¼ êµ¬ë…í•˜ì—¬ ë°ì´í„°ë¥¼ ì†Œë¹„|


- ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¶œë°œí•œ propsì¸ 'data'ëŠ” ê³µê¸‰ìì— ë³´ê´€ëœë‹¤.
- ê³µê¸‰ìëŠ” 'data'ë¥¼ ì†Œë¹„ì(=ìµœí•˜ìœ„ ì»´í¬ë„ŒíŠ¸, ì¦‰ ì „ë‹¬í•  ì»´í¬ë„ŒíŠ¸) ì—ê²Œ ì „ë‹¬í•œë‹¤. 
-> ì»´í¬ë„ŒíŠ¸ ê°„ì˜ ìë£Œ ì˜ì¡´ì„±ì´ ì—†ì–´ì§.

<img src="https://velog.velcdn.com/cloudflare/thisisyjin/30b98ddc-cfe7-4a25-b056-85c6cce3b075/Frame%201%20(2).jpg" width="100%" />


- ê³µê¸‰ìëŠ” ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ í•˜ìœ„ì— í¬í•¨ë˜ì–´ìˆê³ , ì†Œë¹„ìëŠ” í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ì´ë©° RowCComponent í•˜ìœ„ì— ìˆëŠ” êµ¬ì¡°.


### ê³µê¸‰ìì™€ ì†Œë¹„ì
**1. ì†Œë¹„ìëŠ” ê³µê¸‰ìë³´ë‹¤ ë‚®ì€ ê³„ì¸µì— ìˆì–´ì•¼ í•œë‹¤.**
-> ì†Œë¹„ìê°€ ê³µê¸‰ìë³´ë‹¤ ìƒìœ„ì— ìˆìœ¼ë©´, ê³µê¸‰ìë¥¼ êµ¬ë…í•  ìˆ˜ ì—†ë‹¤.


**2. ì†Œë¹„ìëŠ” ê³µê¸‰ìê°€ ì œê³µí•˜ëŠ” ì½œë°± í•¨ìˆ˜ë¡œ ë°ì´í„°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.**
-> ì†Œë¹„ìëŠ” ê³µê¸‰ìì˜ í•˜ìœ„ê³„ì¸µì´ì§€ë§Œ, ê³µê¸‰ìì˜ ë°ì´í„°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
-> ì§ì ‘ ë³€ê²½ì€ X. ê³µê¸‰ìë¡œë¶€í„° ë°ì´í„° ë³€ê²½ì„ ìœ„í•œ **ì½œë°±ì„ ë°›ì•„ ë°ì´í„° ë³€ê²½ ìš”ì²­**ì„ í•¨.

>- ê³µê¸‰ìëŠ” ì†Œë¹„ìì—ê²Œ **ì½œë°±í•¨ìˆ˜**ë¥¼ ì „ë‹¬í•¨.
> - ì†Œë¹„ìëŠ” ì½œë°±í•¨ìˆ˜ì— ì¸ìë¡œ ìì‹ ì´ ì†í•œ **ì»´í¬ë„ŒíŠ¸ì˜ ë°ì´í„°ë¥¼ ì „ë‹¬**í•¨.(ë³€ê²½ ìš”ì²­)

-> ê³µê¸‰ìì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ì—ˆìœ¼ë¯€ë¡œ ì†Œë¹„ìì™€ ë™ì¼í•˜ê²Œ ë§ì¶¤.
-> Data Down, Action Up (DDAU) ë¼ê³  ë¶€ë¦„.

![](https://velog.velcdn.com/cloudflare/thisisyjin/f7807f16-a440-485e-9931-f0f36501347c/Frame%203.jpg)

- ë‹¨ë°©í–¥ ë°ì´í„° íë¦„ - ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€

<br>

___

### 1. ê³µê¸‰ì êµ¬í˜„
- ë°ì´í„° ì œê³µí•¨ìˆ˜ `getChildContext` ì •ì˜
- setStateë¥¼ í¬í•¨í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì†Œë¹„ìì—ê²Œ ì „ë‹¬í•˜ì—¬ ë³€ê²½ ê°€ëŠ¥í•˜ê²Œ í•¨. (setLoading)

/src/component/ctx/HomePageComponent.jsx

```jsx
// ê³µê¸‰ì êµ¬í˜„ - ê³µê¸‰ì ì—­í• ì„ í•  ê³µê¸‰ìì˜ ìë£Œí˜•(childContextTypes)ê³¼, ë°ì´í„° ì œê³µí•¨ìˆ˜(getChildContext) ì •ì˜

import React, { PureComponent } from 'react';
import PropTypes from 'prop-types';
import Button from '../Button';
import ButtonWithContext from './ButtonWithContext';  // ì†Œë¹„ì.

function RowBComponent() {
  return <Button>ë²„íŠ¼</Button>;
}

function RowCComponent() {
  return <ButtonWithContext>ë²„íŠ¼</ButtonWithContext>;  // ì†Œë¹„ìì¸ ButtonWithContextë¥¼ ì¶œë ¥
}

function TableComponent() {
  return (
    <table>
      <RowBComponent />
      <RowCComponent />
    </table>
  );
}

class HomePageComponent extends PureComponent {
  constructor(props) {
    super(props);

    this.state = { loading: false };
    this.setLoading = this.setLoading.bind(this);  // setLoadingì„ ì†Œë¹„ìì— ì „ë‹¬í•˜ì—¬ ë°ì´í„°ë¥¼ ë³€ê²½í•  ì˜ˆì •.
    // thisë¥¼ ë°”ì¸ë”©í•­ ì†Œë¹„ìì—ì„œ ê³µê¸‰ìì˜ setState()ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•¨.
    this.toggleLoading = this.toggleLoading.bind(this);
  }

  getChildContext() {  // ì†Œë¹„ìëŠ” getChildContextë¡œ loadingê³¼ setLoadingì„ ì „ë‹¬ë°›ì„ ê²ƒì„.
    return {
      loading: this.state.loading,
      setLoading: this.setLoading,
    };
  }

  setLoading(loading) {
    this.setState({ loading });
  }

  toggleLoading() {   
    this.setState(({ loading }) => ({ loading: !loading }));
  }

  render() {
    return (
      <div>
        <TableComponent />
        <Button onPress={this.toggleLoading}>ìƒíƒœ ë³€ê²½</Button> { // toggleLoadingì„ ì‹¤í–‰í•˜ëŠ” ë²„íŠ¼ }
      </div>
    );
  }
}

HomePageComponent.childContextTypes = {  // ì»¨í…ìŠ¤íŠ¸ì˜ ìë£Œí˜• ì •ì˜
  loading: PropTypes.bool,
  setLoading: PropTypes.func,
};

export default HomePageComponent;
```

> ì°¸ê³  - `onClick`ê³¼ `onPress`
``` jsx
onPress = { () => this._onPress(key) }
```
- onPressëŠ” HTML ì–´íŠ¸ë¦¬ë·°íŠ¸ onClickê³¼ ê°™ì§€ë§Œ, ì½œë°±í•¨ìˆ˜ë¥¼ ê°’ìœ¼ë¡œ ë°›ëŠ”ë‹¤.
- ì¦‰, í•¨ìˆ˜ì˜ ë¦¬í„´ê°’ì´ ì•„ë‹Œ í•¨ìˆ˜ ìì²´ë¥¼ ê°’ìœ¼ë¡œ ì „ë‹¬í•´ì¤˜ì•¼ í•œë‹¤.


> ì°¸ê³  2 - PropTypes 
- propTypes - propsì˜ íƒ€ì…ì„ ì •ì˜
- defaultProps - propsì˜ ê¸°ë³¸ê°’ ì •ì˜
- childContextTypes - contextì˜ íƒ€ì… ì •ì˜


<br>

### 2. ì†Œë¹„ì êµ¬í˜„
- ì†Œë¹„ìëŠ” í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬í˜„í•¨.
- ì†Œë¹„ìì˜ ì—­í• ì„ í•  ì»´í¬ë„ŒíŠ¸ì— `contextTypes` ì†ì„±ì„ ì¶”ê°€í•˜ì—¬ ê³µê¸‰ìì—ì„œ **êµ¬ë…í•  í•­ëª© ì •ì˜.**
-> ë§¤ë²ˆ contextTypes ì†ì„±ì„ ì¶”ê°€í•˜ë©´ ë¶ˆí¸í•˜ë¯€ë¡œ, í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ë¥¼ ë„ì….


#### 2-1) ì†Œë¹„ìë¥¼ ë°˜í™˜í•˜ëŠ” í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

- ì§€ë‚œë²ˆì— ì‘ì„±í–ˆë˜ withLoadingì„ ìˆ˜ì •í•˜ì—¬, ì†Œë¹„ìë¥¼ ë°˜í™˜í•˜ëŠ” í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬í˜„.
- contextë¥¼ ì „ë‹¬ë°›ì•„ êµ¬ì¡°ë¶„í•´í• ë‹¹ -> WrappedComponentì˜ propsë¡œ ì „ë‹¬


/src/component/ctx/WithLoadingContext.jsx
``` jsx
import React from 'react';
import PropTypes from 'prop-types';

export default (WrappedComponent) => {   // í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ì„. (WithLoadingContextë¥¼ ë¦¬í„´í•¨)
  const { displayName, name: componentName } = WrappedComponent;
  const wrappedComponentName = displayName || componentName;

  function WithLoadingContext(props, context) {
    const { loading, setLoading } = context;
    return (
      <WrappedComponent {...props} loading={loading} setLoading={setLoading} /> { // âœ… contextë¡œ ë°›ì€ ê°ì²´ë¥¼ ì§ì ‘ í”„ë¡œí¼í‹°ë¡œ ì „ë‹¬í•¨.}
    );
  }
  WithLoadingContext.displayName = `withLoadingContext(${wrappedComponentName})`;
  WithLoadingContext.contextTypes = {
    loading: PropTypes.bool,
    setLoading: PropTypes.func,
  };
  return WithLoadingContext;
};

```

#### 2-2) í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ë¡œ ì†Œë¹„ì ë§Œë“¤ê¸°
- Button ì»´í¬ë„ŒíŠ¸ë¥¼ ì†Œë¹„ìë¡œ ë§Œë“¤ê¸°.
- ìœ„ì—ì„œ ë§Œë“  WithLoadingContext(í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸)ì— Button ì»´í¬ë„ŒíŠ¸ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ ì†Œë¹„ì êµ¬í˜„.


/src/component/ctx/ButtonWithLoadingContext.jsx

```jsx
import React from 'react';
import PropTypes from 'prop-types';
import Button from '../Button';
import WithLoadingContext from './WithLoadingContext';

function ButtonWithLoadingContext({ label, loading, setLoading }) {  // ê³µê¸‰ìì˜ ë°ì´í„°ë¥¼ propsë¡œ ì „ë‹¬ë°›ìŒ
  return (
    <Button onPress={() => setLoading(!loading)}>
      {loading ? 'ë¡œë”© ì¤‘' : label}
    </Button>
  );
}

ButtonWithLoadingContext.propTypes = {
  label: PropTypes.string,
  loading: PropTypes.bool,
  setLoading: PropTypes.func,
};

export default WithLoadingContext(ButtonWithLoadingContext);
```

![](https://velog.velcdn.com/cloudflare/thisisyjin/6f3caaad-7cca-444e-a3ea-f3bc7bd286d8/Frame%203%20(1).jpg)


<br>


### 3. ì»´í¬ë„ŒíŠ¸ì—ì„œ ê³µê¸‰ì ë¶„ë¦¬
- ê³µê¸‰ì êµ¬í˜„ì‹œ ê³µê¸‰ìë¥¼ HomePageComponent(ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸)ì— ì´ˆí•¨ì‹œì¼°ìŒ.
- ê³µê¸‰ìë¥¼ ë¶„ë¦¬í•˜ì—¬ PureComponentê°€ ì•„ë‹Œ Componentë¡œ ì‚¬ìš©.
-> PureComponentëŠ” context ë³€ê²½ì— ëŒ€í•œ ë¹„êµê°€ ìƒëµë˜ì–´ ìˆìŒ.
-> **í•˜ìœ„ ê³µê¸‰ì**ì— í¬í•¨ë˜ì–´ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì´ ë™ê¸°í™”ë˜ì§€ âŒ (render í˜¸ì¶œ ì•ˆí•¨)



/src/component/ctx/LoadingProvider.jsx
``` jsx
import React from 'react';
import PropTypes from 'prop-types';

class LoadingProvider extends React.Component {
  constructor(props) {
    super(props);

    this.state = { loading: false };
    this.setLoading = this.setLoading.bind(this);
  }

  getChildContext() {  // HomePageComponentì— ì‚¬ìš©ëœ ê³µê¸‰ì ë°ì´í„° í•­ëª©ì„ ì˜®ê²¨ë†“ìŒ
    return {
      loading: this.state.loading,
      setLoading: this.state.setLoading,
    };
  }

  setLoading(loading) {
    this.setState({ loading });
  }

  render() {
    return this.props.children;  /// ìì‹ props ë…¸ë“œë¥¼ ì¶œë ¥í•¨.
  }
}

LoadingProvider.childContextTypes = {
  loading: PropTypes.bool,
  setLoading: PropTypes.func,
};
export default LoadingProvider;

```


### 4. HomePageComponentì—ì„œ ê³µê¸‰ì ì½”ë“œ ì‚­ì œ
- ê³µê¸‰ìë¥¼ ë”°ë¡œ ë¶„ë¦¬í–ˆìœ¼ë‹ˆ (LoadingProvider.jsx), ê¸°ì¡´ì— HomePageComponentì— ìˆë˜ ê³µê¸‰ì ì½”ë“œë¥¼ ì‚­ì œ.

/src/component/ctx/HomePageWithProvider

``` jsx
import React, { PureComponent } from 'react';
import Button from '../Button';
import ButtonWithLoadingContext from './ButtonWithLoadingContext';  // ì†Œë¹„ì ì»´í¬ë„ŒíŠ¸
import LoadingProvider from './LoadingProvider';  // ê³µê¸‰ì ì»´í¬ë„ŒíŠ¸

function RowBComponent() {
  return <Button>ë²„íŠ¼</Button>;
}

function RowCComponent() {
  return <ButtonWithLoadingContext>ë²„íŠ¼</ButtonWithLoadingContext>;  // ì†Œë¹„ì ì¶œë ¥
}

function TableComponent() {
  return (
    <table>
      <RowBComponent />
      <RowCComponent />
    </table>
  );
}

class HomePageComponent extends PureComponent {
  render() {
    return (
      <LoadingProvider>  // ê³µê¸‰ì
        <TableComponent />
        <ButtonWithLoadingContext>ìƒíƒœ ë³€ê²½</ButtonWithLoadingContext>  // ì†Œë¹„ì ì¶œë ¥
      </LoadingProvider>
    );
  }
}

export default HomePageComponent;
```


### 5. ìŠ¤í† ë¦¬ë¶ì— ì¶”ê°€

/src/stories/ContextStory.jsx

``` jsx
import React from 'react';
import { storiesOf } from '@storybook/react';

import HomePageComponent from '../component/ctx/HomePageComponent';
import HomePageWithProvider from '../component/ctx/HomePageWithProvider';

storiesOf('HomePageComponent', module)
  .add('ì»¨í…ìŠ¤íŠ¸', () => <HomePageComponent />)
  .add('Provider', () => <HomePageWithProvider />);

```

