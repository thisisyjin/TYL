# React.js

**Today I Learned ... **`react.js`

>ğŸ™‹â€â™‚ï¸ [**React.js Lecture**](https://www.youtube.com/watch?v=KDJNjLZrqJk&list=PLcqDmjxt30RtqbStQqk-eYMK8N-1SYIFn&index=18)

>ğŸ™‹â€ [**My Dev Blog**](https://mywebproject.tistory.com/)



***   

# í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬

> Do IT! React - CH5. í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸


## Recompose ë¼ì´ë¸ŒëŸ¬ë¦¬

#### 1. ì„¤ì¹˜ í›„ import

- yarn ì„¤ì¹˜ (--dev ì•„ë‹˜)
``` bash
> yarn add recompose
```

- ì„í¬íŠ¸ -  ëª¨ë“  í•¨ìˆ˜ ì„í¬íŠ¸í•˜ê¸°ë³´ë‹¤ëŠ” **ì›í•˜ëŠ” í•¨ìˆ˜ë§Œ ì¶”ì¶œ**í•˜ì—¬ ì„í¬íŠ¸í•˜ê¸°.

``` jsx
// âŒ ë¹„íš¨ìœ¨ì  - í”„ë¡œì íŠ¸ê°€ ë¬´ê±°ì›Œì§
import { branch, withState } from 'recompose';

// ğŸ’¡ íš¨ìœ¨ì 
import branch from 'recompose/branch';
import withState from 'recompose/withState';
```

### branch()

> **âœ… branch() í•¨ìˆ˜** 
- ì¡°ê±´ì— ë”°ë¼ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ ì¶œë ¥
>
``` jsx
branch(
  condition: props => boolean,
  left: HigherOrderComponent,
  right: HigherOrderComponent
  )(WrappedComponent)
```
> 
- `condition`ì— ì¶œë ¥ì¡°ê±´ì„ ì •ì˜í•œ í•¨ìˆ˜ê°€ ë“¤ì–´ê°€ê³ ,
- `left`ëŠ” ì°¸ì¼ë•Œ ì¶œë ¥ë  ì»´í¬ë„ŒíŠ¸,
- `right`ì—ëŠ” ê±°ì§“ì¼ ë•Œ ì¶œë ¥ë  ì»´í¬ë„ŒíŠ¸ê°€ ë“¤ì–´ê°. (rightëŠ” ìƒëµê°€ëŠ¥)


#### 2. branch()í•¨ìˆ˜ë¡œ ë¡œë”©ìƒíƒœ í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ìƒì„±

/src/component/branch.jsx
``` jsx
import React from 'react';
import branch from 'recompose/branch';
import Button from '../component/Button';

function isLoading(props) {
    return props.isLoading;
}

function LoadingButton(props) {
    return <Button disabled>ë¡œë”© ì¤‘</Button>
}

export default branch(
    isLoading,       // isLoadingì´ ì°¸ì´ë©´ - props.isLoadingì„ ë°˜í™˜ (ë¡œë”© ë©”ì‹œì§€)
    () => LoadingButton,  // ë¡œë”© ì™„ë£Œì‹œ - LoadingButton ì»´í¬ë„ŒíŠ¸ë¥¼ ë°˜í™˜
)(Button);
```
ê°„ëµí•˜ê²Œ í‘œí˜„í•˜ë©´?

``` jsx
import React from 'react';
import branch from 'recompose/branch';
import Button from '../component/Button';

export default branch(
  ({ isLoading }) => isLoading,   // (props)ë¥¼ êµ¬ì¡°ë¶„í•´í• ë‹¹ -> ë¦¬í„´í•˜ëŠ” ê°’(=isLoading)ì´ props.isLoadingê°€ ë¨.
  () => () => <Button disabled>ë¡œë”© ì¤‘</Button> // LoadingButtonì„ í™”ì‚´í‘œí•¨ìˆ˜ì‹ìœ¼ë¡œ í‘œí˜„
)(Button);

```


#### 3. ìŠ¤í† ë¦¬ë¶ì— ì¶”ê°€

/src/stories/BranchStory.jsx
``` jsx
import React from 'react';
import { storiesOf } from '@storybook/react';

import BranchLoaingButton from '../component/branch';

storiesOf('Branch', module)
  .add('ê¸°ë³¸ ì„¤ì •', () => <BranchLoaingButton>ì•ˆë…•í•˜ì„¸ìš”</BranchLoaingButton>)
  .add('isLoading ì˜ˆì œ', () => (
    <BranchLoaingButton isLoading>ì•ˆë…•í•˜ì„¸ìš”</BranchLoaingButton>
  ));
```

```bash
> npm run storybook
```

***

### withState() 


- í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ëŠ” stateë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì§€ë§Œ, **í”„ë¡œí¼í‹°ì™€ ì½œë°±**ì„ í™œìš©í•´ ìš°íšŒì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•¨.
- withState()ëŠ” í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ë„ stateë¥¼ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ í•´ì¤Œ.
(this.stateë‚˜ this.setState ì—†ì´ë„ state ë³€ê²½ ê°€ëŠ¥)

``` jsx
withState(
  stateName: string,  // ì „ë‹¬í•  í”„ë¡œí¼í‹° ì´ë¦„
  stateUpdater: string,  // stateë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ì½œë°± í•¨ìˆ˜ í”„ë¡œí¼í‹°ëª…
  initialState: any,  // stateì˜ ì´ˆê¸°ê°’
  )(WrappedComponent)
```



#### 1. withState() í•¨ìˆ˜ë¡œ ì¹´ìš´íŠ¸ ê´€ë¦¬ state êµ¬í˜„

/src/component/withState.jsx
``` jsx
import React from 'react';
import withState from 'recompose/withState';
import Button from '../component/Button';

export const withCountState = withState('count', 'setCount', 0);

```

<br>

####  2. Counter ì»´í¬ë„ŒíŠ¸ ì¬êµ¬ì„± 

```jsx
import React from 'react';
import withState from 'recompose/withState';
import Button from '../component/Button';

export const withCountState = withState('count', 'setCount', 0);

function Counter({ count, setCount }) {
  const increaseCount = () => setCount((value) => value + 1);

  return (
    <div>
      í˜„ì¬ ì¹´ìš´íŠ¸ : {count}
      <Button onPress={increaseCount}>ì¹´ìš´íŠ¸ ì¦ê°€</Button>
    </div>
  );
}

```

- ê¸°ì¡´ì— stateë¥¼ ì“°ë˜ Counterê³¼ ë¹„êµí•´ë³´ì!
``` jsx
import React from "react";

class NewCounter extends React.Component{
  constructor(props) {
    super(props);
    this.state = {};
    this.increaseCount = this.increaseCount.bind(this);
  }

  static getDerivedStateFromProps(props, state) {  // 
    const { count } = props;  // propsë¡œ ë¶€ëª¨ì˜ stateì¸ countë¥¼ ë°›ê³ ,
    return {
      count,
      newCount: count === state.count ? state.newCount : count,  // ìì‹ ì˜ stateë¡œ í• ë‹¹
    };
  }

  increaseCount() {
    this.setState(({ newCount }) => ({
      newCount: newCount + 1,  // ìì‹ ì˜ stateë¡œ ë“±ë¡í•œ newCount ì¡°ì‘ (setState)
    }));
  }
  render() {
    return (
      <div>
        í˜„ì¬ ì¹´ìš´íŠ¸ : {this.state.newCount}
        <button onClick={this.increaseCount}>ì¹´ìš´íŠ¸ ì¦ê°€</button>
      </div>
    );
  }
}

export default NewCounter;

```

> ğŸ“Œ static **getDerivedStateFormProps(props, state)**
getDerivedStateFormProps() í•¨ìˆ˜ëŠ” `ì •ì  í•¨ìˆ˜`ì´ë‹¤.
-> this.propsë‚˜ this.stateë¡œ ì ‘ê·¼ ëª»í•¨.
- ì¸ìë¡œ ì „ë‹¬ëœ props, stateë¥¼ ì‚¬ìš©í•´ì•¼ í•¨.
- ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°›ì€ propsë¡œ stateê°’ì„ ì—°ë™í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©.
- **returnê°’ìœ¼ë¡œ setState í•´ì¤Œ.**




- withState() í•¨ìˆ˜ì—ì„œ ì •ì˜í•œ countì™€ setCountë¥¼ í”„ë¡œí¼í‹°ë¡œ ë°›ì•„ ì‚¬ìš©í•¨.
- setCountì˜ ì¸ìë¡œëŠ” withState()í•¨ìˆ˜ì˜ ì²«ë²ˆì§¸ ì¸ìì¸ `count`ë¥¼ ì¡°ì ˆí•  í•¨ìˆ˜ë¥¼ ì „ë‹¬í•¨.


- ë³€ê²½ ì½œë°± í•¨ìˆ˜(setCount)ëŠ” ê°’ì„ ì¸ìë¡œ ì§ì ‘ ì „ë‹¬í•´ë„ ë˜ê³ , í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ stateê°’ì— ì ‘ê·¼í•´ì„œ ë³€ê²½í•´ë„ ëœë‹¤.
```jsx
setCount(0);  // 1) ê°’ì„ ì¸ìë¡œ ì „ë‹¬ - countë¥¼ 0ìœ¼ë¡œ ì„¤ì •
setCount(c => c + 1);  // 2) í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ì „ë‹¬ - state(=count)ì— ì ‘ê·¼í•˜ì—¬ ë³€ê²½
setCount(c => c * 10);
```

<br>

#### 3. Counter ì»´í¬ë„ŒíŠ¸ë¥¼ `withCountState()`ì— ì „ë‹¬í•˜ì—¬ export


``` jsx
...
export const CounterWithCountState = withCountState(Counter);
```
- defaultê°€ ì•„ë‹Œ CounterWithCountState ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ (export const) ìµìŠ¤í¬íŠ¸ í•¨.

``` jsx
withState('count', 'setCount', 0)(Counter) // ìœ„ ì½”ë“œëŠ” ì´ì™€ ê°™ìŒ. 
// countëŠ” Counterì˜ propsë¡œ ë³€í™˜ë˜ì–´ ì „ë‹¬ë˜ëŠ” ê²ƒ
```



<br>

#### 4. ìŠ¤í† ë¦¬ë¶ì— ì¶”ê°€

``` jsx
import React from 'react';
import { storiesOf } from '@storybook/react';

import { CounterWithCountState } from '../component/withState';

storiesOf('WithState', module).add('CounterWithCountState', () => (
  <CounterWithCountState />
));

```


***

### lifecycle() 

- í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ë„ ìƒëª…ì£¼ê¸° í•¨ìˆ˜ë¥¼ ì ìš©í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©.


- lifecycle()ì„ í†µí•´ ìš°íšŒì ìœ¼ë¡œ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì— ìƒëª…ì£¼ê¸° í•¨ìˆ˜ë¥¼ ì¶”ê°€ ê°€ëŠ¥.
- í´ë˜ìŠ¤í˜• ì»´í¬ë„ŒíŠ¸ì˜ ê²½ìš°, ìƒëª…ì£¼ê¸° í•¨ìˆ˜ì—ì„œ ì“¸ ë°˜ë³µ ì½”ë“œë¥¼ lifecycle() í•¨ìˆ˜ë¡œ ë¬¶ì–´ ì¬ì‚¬ìš© ê°€ëŠ¥.


``` jsx
lifecycle({
  [lifeCycleMethod: string]: function,    // í•¨ìˆ˜ ì´ë¦„(componentDidUpdate ë“±)
  state: Object,    // stateì˜ ì´ˆê¸°ê°’
})(WrappedComponent)
```


- lifecycle í•¨ìˆ˜ëŠ” this.propsì— ì ‘ê·¼ ê°€ëŠ¥ -> ì»¤ë§ì„ í†µí•´ ë”°ë¡œ propsë¥¼ ì „ë‹¬ë°›ì„ í•„ìš” X
- BUT. í™”ì‚´í‘œ í•¨ìˆ˜ ì‚¬ìš© ë¶ˆê°€. 
(í™”ì‚´í‘œ í•¨ìˆ˜ëŠ” thisì˜ ë²”ìœ„ê°€ ì„ ì–¸ëœ êµ¬ë¬¸ì˜ ë²”ìœ„ë¡œ ê³ ì •ë˜ë¯€ë¡œ)
- í•¨ìˆ˜ ë‚´ë¶€ì—ëŠ” ìƒëª…ì£¼ê¸°í•¨ìˆ˜ ì´ë¦„ê³¼ stateì´ˆê¸°ê°’ ì„¤ì • ê°€ëŠ¥.


- setState()ë¡œ ì„¤ì •ëœ stateê°’ì€ WrappedComponentì—  propsë¡œ ë³€í™˜ë˜ì–´ ì „ë‹¬ë¨.



<br>

#### 1. lifecycle()í•¨ìˆ˜ë¡œ ìµœì´ˆ ìƒì„±ì‹œ ë°ì´í„° ìš”ì²­

/src/component/lifecycle.jsx
``` jsx
import React from 'react';
import lifecycle from 'recompose/lifecycle'; 

function Page({ content }) {   // lifecycle() ì•ˆì— ìˆëŠ” contentë¥¼ í”„ë¡œí¼í‹°(props)ë¡œ ì „ë‹¬í•¨
  return (
    <div>
      í˜ì´ì§€ ë¡œë”©ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
      {content}
    </div>
  );
}

export const withLoadData = lifecycle({
  state: { isLoading: true, content: '' },   // state ì´ˆê¸°ê°’
  componentDidMount: function () {     // ì´ˆê¸° ë Œë”ë§ ì™„ë£Œì‹œ (+ í™”ì‚´í‘œí•¨ìˆ˜ ëª»ì”€)
    if (this.props.loadData) {    // loadData í”„ë¡œí¼í‹°ì— í•¨ìˆ˜ê°€ ì„ ì–¸ëœ ê²½ìš°ì—ë§Œ ì‹¤í–‰ë˜ë„ë¡
      this.props.loadData().then((content) =>  // ë¡œë”© ì™„ë£Œì‹œ(then) ì—ë§Œ stateê°€ ë°”ë€Œê²Œ
        this.setState({
          isLoading: false,
          content,
        })
      );
    }
  },
});

export const PageWithLoadData = withLoadData(Page);  // lifecycle()ë¡œ ë§Œë“  í•˜ì´ì–´ì˜¤ë” ì»´í¬ë„ŒíŠ¸ ìƒì„± í•¨ìˆ˜(withLoadData)ë¥¼ Page ì»´í¬ë„ŒíŠ¸ì— ì ìš©.

```
- ì—¬ê¸°ì„œ lifecycleì—ì„œì˜ stateê°€ (setState()ë¡œ ë°”ë€ state) Page ì»´í¬ë„ŒíŠ¸ì— í”„ë¡œí¼í‹°ë¡œ ì „ë‹¬ë˜ëŠ” ê²ƒ.
- ê¸°ì¡´ì˜ ì„œë²„ ë°ì´í„°ë¥¼ í˜¸ì¶œí•˜ëŠ” ì˜ˆì œì„. (loadDataì™€ then)


<br>

#### 2. ìŠ¤í† ë¦¬ë¶ì— ì¶”ê°€

``` jsx
import React from 'react';
import { storiesOf } from '@storybook/react';

import { PageWithLoadData } from '../component/lifecycle';

storiesOf('LifeCycle', module).add('loadData ì˜ˆì œ', () => (
  <PageWithLoadData loadData={() => fetch('/').then(() => 'hello')} />
));

```

- fetch() í•¨ìˆ˜ë¡œ ì„œë²„ë°ì´í„° í˜¸ì¶œ.
- ì„œë²„ë°ì´í„° í˜¸ì¶œ ì™„ë£Œì‹œ - 'hello' ë¥¼ ë°˜í™˜í•˜ì—¬ (lifecycle.jsxì˜) **loadData() í•¨ìˆ˜ì˜ thení•¨ìˆ˜ ì¸ìë¡œ ì „ë‹¬**.

ğŸ”» dev tool - [Network] íƒ­ (localhostë¡œ ì„œë²„ìš”ì²­ì´ ìš”ì²­ë¨)

![](https://imagedelivery.net/v7-TZByhOiJbNM9RaUdzSA/a30aeddc-28ce-45ca-76a4-93cabed07500/public)


***


## ì •ë¦¬

### recompose ë¼ì´ë¸ŒëŸ¬ë¦¬
- recomposeëŠ” ë°˜ë³µí•´ì„œ ì…ë ¥í•´ì•¼í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©. (ì½”ë“œì˜ ì–‘ì„ ì¤„ì—¬ì•¼ í•  ë•Œ)
- ì ì ˆí•  ë•Œ ìµœì†Œí•œìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ.

>### branch
- ì¡°ê±´ì— ë”°ë¼ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ ì¶œë ¥

>### withState
- í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œë„ state ì‚¬ìš© ê°€ëŠ¥ (props, callback ì´ìš© -> ìš°íšŒì ìœ¼ë¡œ)

>### lifecycle
- í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œë„ lifecycle method ì‚¬ìš© ê°€ëŠ¥
